"use client";

import { Accordion, AccordionDetails, AccordionSummary, Box, Typography } from "@mui/material";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import SeverityChip from "../../common/SeverityChip";
import type { Vulnerability } from "./types";

export interface VulnerabilityItemProps {
  vuln: Vulnerability;
}

export default function VulnerabilityItem({ vuln }: VulnerabilityItemProps) {
  return (
    <Accordion disableGutters>
      <AccordionSummary expandIcon={<ExpandMoreIcon />}>
        <Box sx={{ display: "flex", alignItems: "center", gap: 2, width: "100%", justifyContent: "space-between" }}>
          <Typography variant="subtitle1" sx={{ fontWeight: 600 }}>{vuln.title}</Typography>
          <SeverityChip severity={vuln.severity} />
        </Box>
      </AccordionSummary>
      <AccordionDetails>
        <Typography variant="caption" sx={{ color: "text.secondary", fontFamily: "monospace" }}>
          {vuln.location}
        </Typography>
        <Box sx={{ mt: 1.5 }}>
          {vuln.steps.map((s, idx) => (
            <Typography key={idx} variant="body2" sx={{ color: "text.secondary" }}>
              â†’ {s.description}
            </Typography>
          ))}
        </Box>
      </AccordionDetails>
    </Accordion>
  );
}

